{"ast":null,"code":"import { OrthographicCamera, Scene, UniformsUtils, ShaderMaterial, PlaneGeometry, Mesh, Texture, LinearFilter, MeshBasicMaterial, DoubleSide } from \"three\";\nimport { UnpackDepthRGBAShader } from \"../shaders/UnpackDepthRGBAShader.js\";\nclass ShadowMapViewer {\n  constructor(light) {\n    const scope = this;\n    const doRenderLabel = light.name !== void 0 && light.name !== \"\";\n    let userAutoClearSetting;\n    const frame = {\n      x: 10,\n      y: 10,\n      width: 256,\n      height: 256\n    };\n    const camera = new OrthographicCamera(window.innerWidth / -2, window.innerWidth / 2, window.innerHeight / 2, window.innerHeight / -2, 1, 10);\n    camera.position.set(0, 0, 2);\n    const scene = new Scene();\n    const shader = UnpackDepthRGBAShader;\n    const uniforms = UniformsUtils.clone(shader.uniforms);\n    const material = new ShaderMaterial({\n      uniforms,\n      vertexShader: shader.vertexShader,\n      fragmentShader: shader.fragmentShader\n    });\n    const plane = new PlaneGeometry(frame.width, frame.height);\n    const mesh = new Mesh(plane, material);\n    scene.add(mesh);\n    let labelCanvas, labelMesh;\n    if (doRenderLabel) {\n      labelCanvas = document.createElement(\"canvas\");\n      const context = labelCanvas.getContext(\"2d\");\n      context.font = \"Bold 20px Arial\";\n      const labelWidth = context.measureText(light.name).width;\n      labelCanvas.width = labelWidth;\n      labelCanvas.height = 25;\n      context.font = \"Bold 20px Arial\";\n      context.fillStyle = \"rgba( 255, 0, 0, 1 )\";\n      context.fillText(light.name, 0, 20);\n      const labelTexture = new Texture(labelCanvas);\n      labelTexture.magFilter = LinearFilter;\n      labelTexture.minFilter = LinearFilter;\n      labelTexture.needsUpdate = true;\n      const labelMaterial = new MeshBasicMaterial({\n        map: labelTexture,\n        side: DoubleSide\n      });\n      labelMaterial.transparent = true;\n      const labelPlane = new PlaneGeometry(labelCanvas.width, labelCanvas.height);\n      labelMesh = new Mesh(labelPlane, labelMaterial);\n      scene.add(labelMesh);\n    }\n    function resetPosition() {\n      scope.position.set(scope.position.x, scope.position.y);\n    }\n    this.enabled = true;\n    this.size = {\n      width: frame.width,\n      height: frame.height,\n      set: function (width, height) {\n        this.width = width;\n        this.height = height;\n        mesh.scale.set(this.width / frame.width, this.height / frame.height, 1);\n        resetPosition();\n      }\n    };\n    this.position = {\n      x: frame.x,\n      y: frame.y,\n      set: function (x, y) {\n        this.x = x;\n        this.y = y;\n        const width = scope.size.width;\n        const height = scope.size.height;\n        mesh.position.set(-window.innerWidth / 2 + width / 2 + this.x, window.innerHeight / 2 - height / 2 - this.y, 0);\n        if (doRenderLabel) labelMesh.position.set(mesh.position.x, mesh.position.y - scope.size.height / 2 + labelCanvas.height / 2, 0);\n      }\n    };\n    this.render = function (renderer) {\n      if (this.enabled) {\n        uniforms.tDiffuse.value = light.shadow.map.texture;\n        userAutoClearSetting = renderer.autoClear;\n        renderer.autoClear = false;\n        renderer.clearDepth();\n        renderer.render(scene, camera);\n        renderer.autoClear = userAutoClearSetting;\n      }\n    };\n    this.updateForWindowResize = function () {\n      if (this.enabled) {\n        camera.left = window.innerWidth / -2;\n        camera.right = window.innerWidth / 2;\n        camera.top = window.innerHeight / 2;\n        camera.bottom = window.innerHeight / -2;\n        camera.updateProjectionMatrix();\n        this.update();\n      }\n    };\n    this.update = function () {\n      this.position.set(this.position.x, this.position.y);\n      this.size.set(this.size.width, this.size.height);\n    };\n    this.update();\n  }\n}\nexport { ShadowMapViewer };","map":{"version":3,"names":["OrthographicCamera","Scene","UniformsUtils","ShaderMaterial","PlaneGeometry","Mesh","Texture","LinearFilter","MeshBasicMaterial","DoubleSide","UnpackDepthRGBAShader","ShadowMapViewer","constructor","light","scope","doRenderLabel","name","userAutoClearSetting","frame","x","y","width","height","camera","window","innerWidth","innerHeight","position","set","scene","shader","uniforms","clone","material","vertexShader","fragmentShader","plane","mesh","add","labelCanvas","labelMesh","document","createElement","context","getContext","font","labelWidth","measureText","fillStyle","fillText","labelTexture","magFilter","minFilter","needsUpdate","labelMaterial","map","side","transparent","labelPlane","resetPosition","enabled","size","scale","render","renderer","tDiffuse","value","shadow","texture","autoClear","clearDepth","updateForWindowResize","left","right","top","bottom","updateProjectionMatrix","update"],"sources":["/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/three-stdlib@2.23.7_three@0.151.3/node_modules/three-stdlib/utils/ShadowMapViewer.js"],"sourcesContent":["import { OrthographicCamera, Scene, UniformsUtils, ShaderMaterial, PlaneGeometry, Mesh, Texture, LinearFilter, MeshBasicMaterial, DoubleSide } from \"three\";\nimport { UnpackDepthRGBAShader } from \"../shaders/UnpackDepthRGBAShader.js\";\nclass ShadowMapViewer {\n  constructor(light) {\n    const scope = this;\n    const doRenderLabel = light.name !== void 0 && light.name !== \"\";\n    let userAutoClearSetting;\n    const frame = {\n      x: 10,\n      y: 10,\n      width: 256,\n      height: 256\n    };\n    const camera = new OrthographicCamera(\n      window.innerWidth / -2,\n      window.innerWidth / 2,\n      window.innerHeight / 2,\n      window.innerHeight / -2,\n      1,\n      10\n    );\n    camera.position.set(0, 0, 2);\n    const scene = new Scene();\n    const shader = UnpackDepthRGBAShader;\n    const uniforms = UniformsUtils.clone(shader.uniforms);\n    const material = new ShaderMaterial({\n      uniforms,\n      vertexShader: shader.vertexShader,\n      fragmentShader: shader.fragmentShader\n    });\n    const plane = new PlaneGeometry(frame.width, frame.height);\n    const mesh = new Mesh(plane, material);\n    scene.add(mesh);\n    let labelCanvas, labelMesh;\n    if (doRenderLabel) {\n      labelCanvas = document.createElement(\"canvas\");\n      const context = labelCanvas.getContext(\"2d\");\n      context.font = \"Bold 20px Arial\";\n      const labelWidth = context.measureText(light.name).width;\n      labelCanvas.width = labelWidth;\n      labelCanvas.height = 25;\n      context.font = \"Bold 20px Arial\";\n      context.fillStyle = \"rgba( 255, 0, 0, 1 )\";\n      context.fillText(light.name, 0, 20);\n      const labelTexture = new Texture(labelCanvas);\n      labelTexture.magFilter = LinearFilter;\n      labelTexture.minFilter = LinearFilter;\n      labelTexture.needsUpdate = true;\n      const labelMaterial = new MeshBasicMaterial({ map: labelTexture, side: DoubleSide });\n      labelMaterial.transparent = true;\n      const labelPlane = new PlaneGeometry(labelCanvas.width, labelCanvas.height);\n      labelMesh = new Mesh(labelPlane, labelMaterial);\n      scene.add(labelMesh);\n    }\n    function resetPosition() {\n      scope.position.set(scope.position.x, scope.position.y);\n    }\n    this.enabled = true;\n    this.size = {\n      width: frame.width,\n      height: frame.height,\n      set: function(width, height) {\n        this.width = width;\n        this.height = height;\n        mesh.scale.set(this.width / frame.width, this.height / frame.height, 1);\n        resetPosition();\n      }\n    };\n    this.position = {\n      x: frame.x,\n      y: frame.y,\n      set: function(x, y) {\n        this.x = x;\n        this.y = y;\n        const width = scope.size.width;\n        const height = scope.size.height;\n        mesh.position.set(-window.innerWidth / 2 + width / 2 + this.x, window.innerHeight / 2 - height / 2 - this.y, 0);\n        if (doRenderLabel)\n          labelMesh.position.set(mesh.position.x, mesh.position.y - scope.size.height / 2 + labelCanvas.height / 2, 0);\n      }\n    };\n    this.render = function(renderer) {\n      if (this.enabled) {\n        uniforms.tDiffuse.value = light.shadow.map.texture;\n        userAutoClearSetting = renderer.autoClear;\n        renderer.autoClear = false;\n        renderer.clearDepth();\n        renderer.render(scene, camera);\n        renderer.autoClear = userAutoClearSetting;\n      }\n    };\n    this.updateForWindowResize = function() {\n      if (this.enabled) {\n        camera.left = window.innerWidth / -2;\n        camera.right = window.innerWidth / 2;\n        camera.top = window.innerHeight / 2;\n        camera.bottom = window.innerHeight / -2;\n        camera.updateProjectionMatrix();\n        this.update();\n      }\n    };\n    this.update = function() {\n      this.position.set(this.position.x, this.position.y);\n      this.size.set(this.size.width, this.size.height);\n    };\n    this.update();\n  }\n}\nexport {\n  ShadowMapViewer\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}