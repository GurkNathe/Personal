{"ast":null,"code":"import _createClass from \"/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _classCallCheck from \"/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport { OrthographicCamera, Scene, UniformsUtils, ShaderMaterial, PlaneGeometry, Mesh, Texture, LinearFilter, MeshBasicMaterial, DoubleSide } from \"three\";\nimport { UnpackDepthRGBAShader } from \"../shaders/UnpackDepthRGBAShader.js\";\nvar ShadowMapViewer = /*#__PURE__*/_createClass(function ShadowMapViewer(light) {\n  _classCallCheck(this, ShadowMapViewer);\n  var scope = this;\n  var doRenderLabel = light.name !== void 0 && light.name !== \"\";\n  var userAutoClearSetting;\n  var frame = {\n    x: 10,\n    y: 10,\n    width: 256,\n    height: 256\n  };\n  var camera = new OrthographicCamera(window.innerWidth / -2, window.innerWidth / 2, window.innerHeight / 2, window.innerHeight / -2, 1, 10);\n  camera.position.set(0, 0, 2);\n  var scene = new Scene();\n  var shader = UnpackDepthRGBAShader;\n  var uniforms = UniformsUtils.clone(shader.uniforms);\n  var material = new ShaderMaterial({\n    uniforms: uniforms,\n    vertexShader: shader.vertexShader,\n    fragmentShader: shader.fragmentShader\n  });\n  var plane = new PlaneGeometry(frame.width, frame.height);\n  var mesh = new Mesh(plane, material);\n  scene.add(mesh);\n  var labelCanvas, labelMesh;\n  if (doRenderLabel) {\n    labelCanvas = document.createElement(\"canvas\");\n    var context = labelCanvas.getContext(\"2d\");\n    context.font = \"Bold 20px Arial\";\n    var labelWidth = context.measureText(light.name).width;\n    labelCanvas.width = labelWidth;\n    labelCanvas.height = 25;\n    context.font = \"Bold 20px Arial\";\n    context.fillStyle = \"rgba( 255, 0, 0, 1 )\";\n    context.fillText(light.name, 0, 20);\n    var labelTexture = new Texture(labelCanvas);\n    labelTexture.magFilter = LinearFilter;\n    labelTexture.minFilter = LinearFilter;\n    labelTexture.needsUpdate = true;\n    var labelMaterial = new MeshBasicMaterial({\n      map: labelTexture,\n      side: DoubleSide\n    });\n    labelMaterial.transparent = true;\n    var labelPlane = new PlaneGeometry(labelCanvas.width, labelCanvas.height);\n    labelMesh = new Mesh(labelPlane, labelMaterial);\n    scene.add(labelMesh);\n  }\n  function resetPosition() {\n    scope.position.set(scope.position.x, scope.position.y);\n  }\n  this.enabled = true;\n  this.size = {\n    width: frame.width,\n    height: frame.height,\n    set: function set(width, height) {\n      this.width = width;\n      this.height = height;\n      mesh.scale.set(this.width / frame.width, this.height / frame.height, 1);\n      resetPosition();\n    }\n  };\n  this.position = {\n    x: frame.x,\n    y: frame.y,\n    set: function set(x, y) {\n      this.x = x;\n      this.y = y;\n      var width = scope.size.width;\n      var height = scope.size.height;\n      mesh.position.set(-window.innerWidth / 2 + width / 2 + this.x, window.innerHeight / 2 - height / 2 - this.y, 0);\n      if (doRenderLabel) labelMesh.position.set(mesh.position.x, mesh.position.y - scope.size.height / 2 + labelCanvas.height / 2, 0);\n    }\n  };\n  this.render = function (renderer) {\n    if (this.enabled) {\n      uniforms.tDiffuse.value = light.shadow.map.texture;\n      userAutoClearSetting = renderer.autoClear;\n      renderer.autoClear = false;\n      renderer.clearDepth();\n      renderer.render(scene, camera);\n      renderer.autoClear = userAutoClearSetting;\n    }\n  };\n  this.updateForWindowResize = function () {\n    if (this.enabled) {\n      camera.left = window.innerWidth / -2;\n      camera.right = window.innerWidth / 2;\n      camera.top = window.innerHeight / 2;\n      camera.bottom = window.innerHeight / -2;\n      camera.updateProjectionMatrix();\n      this.update();\n    }\n  };\n  this.update = function () {\n    this.position.set(this.position.x, this.position.y);\n    this.size.set(this.size.width, this.size.height);\n  };\n  this.update();\n});\nexport { ShadowMapViewer };","map":{"version":3,"names":["OrthographicCamera","Scene","UniformsUtils","ShaderMaterial","PlaneGeometry","Mesh","Texture","LinearFilter","MeshBasicMaterial","DoubleSide","UnpackDepthRGBAShader","ShadowMapViewer","_createClass","light","_classCallCheck","scope","doRenderLabel","name","userAutoClearSetting","frame","x","y","width","height","camera","window","innerWidth","innerHeight","position","set","scene","shader","uniforms","clone","material","vertexShader","fragmentShader","plane","mesh","add","labelCanvas","labelMesh","document","createElement","context","getContext","font","labelWidth","measureText","fillStyle","fillText","labelTexture","magFilter","minFilter","needsUpdate","labelMaterial","map","side","transparent","labelPlane","resetPosition","enabled","size","scale","render","renderer","tDiffuse","value","shadow","texture","autoClear","clearDepth","updateForWindowResize","left","right","top","bottom","updateProjectionMatrix","update"],"sources":["/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/three-stdlib@2.23.7_three@0.151.3/node_modules/three-stdlib/utils/ShadowMapViewer.js"],"sourcesContent":["import { OrthographicCamera, Scene, UniformsUtils, ShaderMaterial, PlaneGeometry, Mesh, Texture, LinearFilter, MeshBasicMaterial, DoubleSide } from \"three\";\nimport { UnpackDepthRGBAShader } from \"../shaders/UnpackDepthRGBAShader.js\";\nclass ShadowMapViewer {\n  constructor(light) {\n    const scope = this;\n    const doRenderLabel = light.name !== void 0 && light.name !== \"\";\n    let userAutoClearSetting;\n    const frame = {\n      x: 10,\n      y: 10,\n      width: 256,\n      height: 256\n    };\n    const camera = new OrthographicCamera(\n      window.innerWidth / -2,\n      window.innerWidth / 2,\n      window.innerHeight / 2,\n      window.innerHeight / -2,\n      1,\n      10\n    );\n    camera.position.set(0, 0, 2);\n    const scene = new Scene();\n    const shader = UnpackDepthRGBAShader;\n    const uniforms = UniformsUtils.clone(shader.uniforms);\n    const material = new ShaderMaterial({\n      uniforms,\n      vertexShader: shader.vertexShader,\n      fragmentShader: shader.fragmentShader\n    });\n    const plane = new PlaneGeometry(frame.width, frame.height);\n    const mesh = new Mesh(plane, material);\n    scene.add(mesh);\n    let labelCanvas, labelMesh;\n    if (doRenderLabel) {\n      labelCanvas = document.createElement(\"canvas\");\n      const context = labelCanvas.getContext(\"2d\");\n      context.font = \"Bold 20px Arial\";\n      const labelWidth = context.measureText(light.name).width;\n      labelCanvas.width = labelWidth;\n      labelCanvas.height = 25;\n      context.font = \"Bold 20px Arial\";\n      context.fillStyle = \"rgba( 255, 0, 0, 1 )\";\n      context.fillText(light.name, 0, 20);\n      const labelTexture = new Texture(labelCanvas);\n      labelTexture.magFilter = LinearFilter;\n      labelTexture.minFilter = LinearFilter;\n      labelTexture.needsUpdate = true;\n      const labelMaterial = new MeshBasicMaterial({ map: labelTexture, side: DoubleSide });\n      labelMaterial.transparent = true;\n      const labelPlane = new PlaneGeometry(labelCanvas.width, labelCanvas.height);\n      labelMesh = new Mesh(labelPlane, labelMaterial);\n      scene.add(labelMesh);\n    }\n    function resetPosition() {\n      scope.position.set(scope.position.x, scope.position.y);\n    }\n    this.enabled = true;\n    this.size = {\n      width: frame.width,\n      height: frame.height,\n      set: function(width, height) {\n        this.width = width;\n        this.height = height;\n        mesh.scale.set(this.width / frame.width, this.height / frame.height, 1);\n        resetPosition();\n      }\n    };\n    this.position = {\n      x: frame.x,\n      y: frame.y,\n      set: function(x, y) {\n        this.x = x;\n        this.y = y;\n        const width = scope.size.width;\n        const height = scope.size.height;\n        mesh.position.set(-window.innerWidth / 2 + width / 2 + this.x, window.innerHeight / 2 - height / 2 - this.y, 0);\n        if (doRenderLabel)\n          labelMesh.position.set(mesh.position.x, mesh.position.y - scope.size.height / 2 + labelCanvas.height / 2, 0);\n      }\n    };\n    this.render = function(renderer) {\n      if (this.enabled) {\n        uniforms.tDiffuse.value = light.shadow.map.texture;\n        userAutoClearSetting = renderer.autoClear;\n        renderer.autoClear = false;\n        renderer.clearDepth();\n        renderer.render(scene, camera);\n        renderer.autoClear = userAutoClearSetting;\n      }\n    };\n    this.updateForWindowResize = function() {\n      if (this.enabled) {\n        camera.left = window.innerWidth / -2;\n        camera.right = window.innerWidth / 2;\n        camera.top = window.innerHeight / 2;\n        camera.bottom = window.innerHeight / -2;\n        camera.updateProjectionMatrix();\n        this.update();\n      }\n    };\n    this.update = function() {\n      this.position.set(this.position.x, this.position.y);\n      this.size.set(this.size.width, this.size.height);\n    };\n    this.update();\n  }\n}\nexport {\n  ShadowMapViewer\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}