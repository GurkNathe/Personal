{"ast":null,"code":"import _slicedToArray from \"/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regeneratorRuntime from \"/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { createError } from '../errors.js';\nimport { uniqueId, formatNanoseconds } from '../utils.js';\nexport { getDocumentProperties } from '../utils.js';\nexport function formatElapsedTime(_x) {\n  return _formatElapsedTime.apply(this, arguments);\n}\nfunction _formatElapsedTime() {\n  _formatElapsedTime = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(n) {\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          _context.t0 = Number(n);\n          _context.next = 3;\n          return formatNanoseconds(n);\n        case 3:\n          _context.t1 = _context.sent;\n          return _context.abrupt(\"return\", {\n            raw: _context.t0,\n            formatted: _context.t1\n          });\n        case 5:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _formatElapsedTime.apply(this, arguments);\n}\nexport function getDocumentIndexId(_x2) {\n  return _getDocumentIndexId.apply(this, arguments);\n}\nfunction _getDocumentIndexId() {\n  _getDocumentIndexId = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(doc) {\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          if (!doc.id) {\n            _context2.next = 4;\n            break;\n          }\n          if (!(typeof doc.id !== 'string')) {\n            _context2.next = 3;\n            break;\n          }\n          throw createError('DOCUMENT_ID_MUST_BE_STRING', typeof doc.id);\n        case 3:\n          return _context2.abrupt(\"return\", doc.id);\n        case 4:\n          _context2.next = 6;\n          return uniqueId();\n        case 6:\n          return _context2.abrupt(\"return\", _context2.sent);\n        case 7:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return _getDocumentIndexId.apply(this, arguments);\n}\nexport function validateSchema(_x3, _x4) {\n  return _validateSchema.apply(this, arguments);\n}\nfunction _validateSchema() {\n  _validateSchema = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(doc, schema) {\n    var _i, _Object$entries, _Object$entries$_i, prop, type, value, typeOfValue, typeOfType, expectedType, valueLength, i, subProp;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          _i = 0, _Object$entries = Object.entries(schema);\n        case 1:\n          if (!(_i < _Object$entries.length)) {\n            _context3.next = 35;\n            break;\n          }\n          _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2), prop = _Object$entries$_i[0], type = _Object$entries$_i[1];\n          value = doc[prop];\n          typeOfValue = typeof value;\n          if (!(typeOfValue === 'undefined')) {\n            _context3.next = 7;\n            break;\n          }\n          return _context3.abrupt(\"continue\", 32);\n        case 7:\n          typeOfType = typeof type;\n          if (!(typeOfType === 'string' && isArrayType(type))) {\n            _context3.next = 21;\n            break;\n          }\n          if (Array.isArray(value)) {\n            _context3.next = 11;\n            break;\n          }\n          return _context3.abrupt(\"return\", prop);\n        case 11:\n          expectedType = getInnerType(type);\n          valueLength = value.length;\n          i = 0;\n        case 14:\n          if (!(i < valueLength)) {\n            _context3.next = 20;\n            break;\n          }\n          if (!(typeof value[i] !== expectedType)) {\n            _context3.next = 17;\n            break;\n          }\n          return _context3.abrupt(\"return\", prop + '.' + i);\n        case 17:\n          i++;\n          _context3.next = 14;\n          break;\n        case 20:\n          return _context3.abrupt(\"continue\", 32);\n        case 21:\n          if (!(typeOfType === 'object')) {\n            _context3.next = 30;\n            break;\n          }\n          if (!(!value || typeOfValue !== 'object')) {\n            _context3.next = 24;\n            break;\n          }\n          return _context3.abrupt(\"return\", prop);\n        case 24:\n          _context3.next = 26;\n          return validateSchema(value, type);\n        case 26:\n          subProp = _context3.sent;\n          if (!subProp) {\n            _context3.next = 29;\n            break;\n          }\n          return _context3.abrupt(\"return\", prop + '.' + subProp);\n        case 29:\n          return _context3.abrupt(\"continue\", 32);\n        case 30:\n          if (!(typeOfValue !== type)) {\n            _context3.next = 32;\n            break;\n          }\n          return _context3.abrupt(\"return\", prop);\n        case 32:\n          _i++;\n          _context3.next = 1;\n          break;\n        case 35:\n          return _context3.abrupt(\"return\", undefined);\n        case 36:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3);\n  }));\n  return _validateSchema.apply(this, arguments);\n}\nvar IS_ARRAY_TYPE = {\n  string: false,\n  number: false,\n  boolean: false,\n  'string[]': true,\n  'number[]': true,\n  'boolean[]': true\n};\nvar INNER_TYPE = {\n  'string[]': 'string',\n  'number[]': 'number',\n  'boolean[]': 'boolean'\n};\nexport function isArrayType(type) {\n  return IS_ARRAY_TYPE[type];\n}\nexport function getInnerType(type) {\n  return INNER_TYPE[type];\n}","map":{"version":3,"names":["createError","uniqueId","formatNanoseconds","getDocumentProperties","formatElapsedTime","_x","_formatElapsedTime","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","n","wrap","_callee$","_context","prev","next","t0","Number","t1","sent","abrupt","raw","formatted","stop","getDocumentIndexId","_x2","_getDocumentIndexId","_callee2","doc","_callee2$","_context2","id","validateSchema","_x3","_x4","_validateSchema","_callee3","schema","_i","_Object$entries","_Object$entries$_i","prop","type","value","typeOfValue","typeOfType","expectedType","valueLength","i","subProp","_callee3$","_context3","Object","entries","length","_slicedToArray","isArrayType","Array","isArray","getInnerType","undefined","IS_ARRAY_TYPE","string","number","boolean","INNER_TYPE"],"sources":["/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@orama+orama@1.0.3/node_modules/@orama/orama/src/components/defaults.ts"],"sourcesContent":["import { createError } from '../errors.js'\nimport { ArraySearchableType, Document, ElapsedTime, ScalarSearchableType, Schema, SearchableType } from '../types.js'\nimport { uniqueId, formatNanoseconds } from '../utils.js'\n\nexport { getDocumentProperties } from '../utils.js'\n\nexport async function formatElapsedTime(n: bigint): Promise<ElapsedTime> {\n  return {\n    raw: Number(n),\n    formatted: await formatNanoseconds(n),\n  }\n}\n\nexport async function getDocumentIndexId(doc: Document): Promise<string> {\n  if (doc.id) {\n    if (typeof doc.id !== 'string') {\n      throw createError('DOCUMENT_ID_MUST_BE_STRING', typeof doc.id)\n    }\n\n    return doc.id\n  }\n\n  return await uniqueId()\n}\n\nexport async function validateSchema<S extends Schema = Schema>(doc: Document, schema: S): Promise<string | undefined> {\n  for (const [prop, type] of Object.entries(schema)) {\n    const value = doc[prop]\n    const typeOfValue = typeof value\n\n    if (typeOfValue === 'undefined') {\n      continue\n    }\n\n    const typeOfType = typeof type\n\n    if (typeOfType === 'string' && isArrayType(type as SearchableType)) {\n      if (!Array.isArray(value)) {\n        return prop\n      }\n      const expectedType = getInnerType(type as ArraySearchableType)\n\n      const valueLength = value.length\n      for (let i = 0; i < valueLength; i++) {\n        if (typeof value[i] !== expectedType) {\n          return prop + '.' + i\n        }\n      }\n\n      continue\n    }\n\n    if (typeOfType === 'object') {\n      if (!value || typeOfValue !== 'object') {\n        return prop\n      }\n\n      const subProp = await validateSchema(value as Document, type as Schema)\n      if (subProp) {\n        return prop + '.' + subProp\n      }\n      continue\n    }\n\n    if (typeOfValue !== type) {\n      return prop\n    }\n  }\n\n  return undefined\n}\n\nconst IS_ARRAY_TYPE: Record<SearchableType, boolean> = {\n  string: false,\n  number: false,\n  boolean: false,\n  'string[]': true,\n  'number[]': true,\n  'boolean[]': true,\n}\nconst INNER_TYPE: Record<ArraySearchableType, ScalarSearchableType> = {\n  'string[]': 'string',\n  'number[]': 'number',\n  'boolean[]': 'boolean',\n}\nexport function isArrayType(type: SearchableType) {\n  return IS_ARRAY_TYPE[type]\n}\nexport function getInnerType(type: ArraySearchableType): ScalarSearchableType {\n  return INNER_TYPE[type]\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}