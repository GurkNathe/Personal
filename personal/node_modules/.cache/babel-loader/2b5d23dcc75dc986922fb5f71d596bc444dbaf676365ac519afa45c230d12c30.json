{"ast":null,"code":"import _regeneratorRuntime from \"/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _toConsumableArray from \"/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _slicedToArray from \"/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@babel+runtime@7.22.3/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { createError } from '../errors.js';\nfunction innerCreate(schema, sortableDeniedProperties, prefix) {\n  var sorter = {\n    enabled: true,\n    sortableProperties: [],\n    sortablePropertiesWithTypes: {},\n    sorts: {}\n  };\n  for (var _i = 0, _Object$entries = Object.entries(schema); _i < _Object$entries.length; _i++) {\n    var _Object$entries$_i = _slicedToArray(_Object$entries[_i], 2),\n      prop = _Object$entries$_i[0],\n      type = _Object$entries$_i[1];\n    var typeActualType = typeof type;\n    var path = \"\".concat(prefix).concat(prefix ? '.' : '').concat(prop);\n    if (sortableDeniedProperties.includes(path)) {\n      continue;\n    }\n    if (typeActualType === 'object' && !Array.isArray(type)) {\n      var _sorter$sortablePrope;\n      // Nested\n      var ret = innerCreate(type, sortableDeniedProperties, path);\n      (_sorter$sortablePrope = sorter.sortableProperties).push.apply(_sorter$sortablePrope, _toConsumableArray(ret.sortableProperties));\n      sorter.sorts = _objectSpread(_objectSpread({}, sorter.sorts), ret.sorts);\n      sorter.sortablePropertiesWithTypes = _objectSpread(_objectSpread({}, sorter.sortablePropertiesWithTypes), ret.sortablePropertiesWithTypes);\n      continue;\n    }\n    switch (type) {\n      case 'boolean':\n      case 'number':\n      case 'string':\n        sorter.sortableProperties.push(path);\n        sorter.sortablePropertiesWithTypes[path] = type;\n        sorter.sorts[path] = {\n          docs: {},\n          orderedDocs: [],\n          type: type\n        };\n        break;\n      case 'boolean[]':\n      case 'number[]':\n      case 'string[]':\n        continue;\n      default:\n        throw createError('INVALID_SORT_SCHEMA_TYPE', Array.isArray(type) ? 'array' : type, path);\n    }\n  }\n  return sorter;\n}\nfunction create(_x, _x2, _x3) {\n  return _create.apply(this, arguments);\n}\nfunction _create() {\n  _create = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(_, schema, config) {\n    var isSortEnabled;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) switch (_context.prev = _context.next) {\n        case 0:\n          isSortEnabled = (config === null || config === void 0 ? void 0 : config.enabled) !== false;\n          if (isSortEnabled) {\n            _context.next = 3;\n            break;\n          }\n          return _context.abrupt(\"return\", {\n            disabled: true\n          });\n        case 3:\n          return _context.abrupt(\"return\", innerCreate(schema, (config || {}).unsortableProperties || [], ''));\n        case 4:\n        case \"end\":\n          return _context.stop();\n      }\n    }, _callee);\n  }));\n  return _create.apply(this, arguments);\n}\nfunction stringSort(value, language, d) {\n  return d[1].localeCompare(value, language) > 0;\n}\nfunction numerSort(value, d) {\n  return d[1] > value;\n}\nfunction booleanSort(value, d) {\n  return d[1];\n}\nfunction insert(_x4, _x5, _x6, _x7, _x8, _x9) {\n  return _insert.apply(this, arguments);\n}\nfunction _insert() {\n  _insert = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(sorter, prop, id, value, schemaType, language) {\n    var s, predicate, index, orderedDocsLength, i, docId;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) switch (_context2.prev = _context2.next) {\n        case 0:\n          if (sorter.enabled) {\n            _context2.next = 2;\n            break;\n          }\n          return _context2.abrupt(\"return\");\n        case 2:\n          s = sorter.sorts[prop];\n          _context2.t0 = schemaType;\n          _context2.next = _context2.t0 === 'string' ? 6 : _context2.t0 === 'number' ? 8 : _context2.t0 === 'boolean' ? 10 : 12;\n          break;\n        case 6:\n          predicate = stringSort.bind(null, value, language);\n          return _context2.abrupt(\"break\", 12);\n        case 8:\n          predicate = numerSort.bind(null, value);\n          return _context2.abrupt(\"break\", 12);\n        case 10:\n          predicate = booleanSort.bind(null, value);\n          return _context2.abrupt(\"break\", 12);\n        case 12:\n          // Find the right position to insert the element\n          index = s.orderedDocs.findIndex(predicate);\n          if (index === -1) {\n            index = s.orderedDocs.length;\n            s.orderedDocs.push([id, value]);\n          } else {\n            s.orderedDocs.splice(index, 0, [id, value]);\n          }\n          s.docs[id] = index;\n          // Increment position for the greather documents\n          orderedDocsLength = s.orderedDocs.length;\n          for (i = index + 1; i < orderedDocsLength; i++) {\n            docId = s.orderedDocs[i][0];\n            s.docs[docId]++;\n          }\n        case 17:\n        case \"end\":\n          return _context2.stop();\n      }\n    }, _callee2);\n  }));\n  return _insert.apply(this, arguments);\n}\nfunction remove(_x10, _x11, _x12) {\n  return _remove.apply(this, arguments);\n}\nfunction _remove() {\n  _remove = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(sorter, prop, id) {\n    var s, index, orderedDocsLength, i, docId;\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) switch (_context3.prev = _context3.next) {\n        case 0:\n          if (sorter.enabled) {\n            _context3.next = 2;\n            break;\n          }\n          return _context3.abrupt(\"return\");\n        case 2:\n          s = sorter.sorts[prop];\n          index = s.docs[id];\n          delete s.docs[id];\n          // Decrement position for the greather documents\n          orderedDocsLength = s.orderedDocs.length;\n          for (i = index + 1; i < orderedDocsLength; i++) {\n            docId = s.orderedDocs[i][0];\n            s.docs[docId]--;\n          }\n          s.orderedDocs.splice(index, 1);\n        case 8:\n        case \"end\":\n          return _context3.stop();\n      }\n    }, _callee3);\n  }));\n  return _remove.apply(this, arguments);\n}\nfunction sortBy(_x13, _x14, _x15) {\n  return _sortBy.apply(this, arguments);\n}\nfunction _sortBy() {\n  _sortBy = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(sorter, docIds, by) {\n    var property, isDesc, s;\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) switch (_context4.prev = _context4.next) {\n        case 0:\n          if (sorter.enabled) {\n            _context4.next = 2;\n            break;\n          }\n          throw createError('SORT_DISABLED');\n        case 2:\n          property = by.property;\n          isDesc = by.order === 'DESC';\n          s = sorter.sorts[property];\n          if (s) {\n            _context4.next = 7;\n            break;\n          }\n          throw createError('UNABLE_TO_SORT_ON_UNKNOWN_FIELD', property, sorter.sortableProperties.join(', '));\n        case 7:\n          docIds.sort(function (a, b) {\n            // This sort algorithm works leveraging on\n            // that s.docs is a map of docId -> position\n            // If a document is not indexed, it will be not present in the map\n            var indexOfA = s.docs[a[0]];\n            var indexOfB = s.docs[b[0]];\n            var isAIndexed = typeof indexOfA !== 'undefined';\n            var isBIndexed = typeof indexOfB !== 'undefined';\n            if (!isAIndexed && !isBIndexed) {\n              return 0;\n            }\n            // unindexed documents are always at the end\n            if (!isAIndexed) {\n              return 1;\n            }\n            if (!isBIndexed) {\n              return -1;\n            }\n            return isDesc ? indexOfB - indexOfA : indexOfA - indexOfB;\n          });\n          return _context4.abrupt(\"return\", docIds);\n        case 9:\n        case \"end\":\n          return _context4.stop();\n      }\n    }, _callee4);\n  }));\n  return _sortBy.apply(this, arguments);\n}\nfunction getSortableProperties(_x16) {\n  return _getSortableProperties.apply(this, arguments);\n}\nfunction _getSortableProperties() {\n  _getSortableProperties = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(sorter) {\n    return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n      while (1) switch (_context5.prev = _context5.next) {\n        case 0:\n          if (sorter.enabled) {\n            _context5.next = 2;\n            break;\n          }\n          return _context5.abrupt(\"return\", []);\n        case 2:\n          return _context5.abrupt(\"return\", sorter.sortableProperties);\n        case 3:\n        case \"end\":\n          return _context5.stop();\n      }\n    }, _callee5);\n  }));\n  return _getSortableProperties.apply(this, arguments);\n}\nfunction getSortablePropertiesWithTypes(_x17) {\n  return _getSortablePropertiesWithTypes.apply(this, arguments);\n}\nfunction _getSortablePropertiesWithTypes() {\n  _getSortablePropertiesWithTypes = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(sorter) {\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          if (sorter.enabled) {\n            _context6.next = 2;\n            break;\n          }\n          return _context6.abrupt(\"return\", {});\n        case 2:\n          return _context6.abrupt(\"return\", sorter.sortablePropertiesWithTypes);\n        case 3:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee6);\n  }));\n  return _getSortablePropertiesWithTypes.apply(this, arguments);\n}\nexport function load(_x18) {\n  return _load.apply(this, arguments);\n}\nfunction _load() {\n  _load = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(raw) {\n    var rawDocument;\n    return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n      while (1) switch (_context7.prev = _context7.next) {\n        case 0:\n          rawDocument = raw;\n          if (rawDocument.enabled) {\n            _context7.next = 3;\n            break;\n          }\n          return _context7.abrupt(\"return\", {\n            enabled: false\n          });\n        case 3:\n          return _context7.abrupt(\"return\", {\n            sortableProperties: rawDocument.sortableProperties,\n            sortablePropertiesWithTypes: rawDocument.sortablePropertiesWithTypes,\n            sorts: rawDocument.sorts,\n            enabled: true\n          });\n        case 4:\n        case \"end\":\n          return _context7.stop();\n      }\n    }, _callee7);\n  }));\n  return _load.apply(this, arguments);\n}\nexport function save(_x19) {\n  return _save.apply(this, arguments);\n}\nfunction _save() {\n  _save = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(sorter) {\n    return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n      while (1) switch (_context8.prev = _context8.next) {\n        case 0:\n          if (sorter.enabled) {\n            _context8.next = 2;\n            break;\n          }\n          return _context8.abrupt(\"return\", {\n            enabled: false\n          });\n        case 2:\n          return _context8.abrupt(\"return\", {\n            sortableProperties: sorter.sortableProperties,\n            sortablePropertiesWithTypes: sorter.sortablePropertiesWithTypes,\n            sorts: sorter.sorts,\n            enabled: sorter.enabled\n          });\n        case 3:\n        case \"end\":\n          return _context8.stop();\n      }\n    }, _callee8);\n  }));\n  return _save.apply(this, arguments);\n}\nexport function createSorter() {\n  return _createSorter.apply(this, arguments);\n}\nfunction _createSorter() {\n  _createSorter = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n    return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n      while (1) switch (_context9.prev = _context9.next) {\n        case 0:\n          return _context9.abrupt(\"return\", {\n            create: create,\n            insert: insert,\n            remove: remove,\n            save: save,\n            load: load,\n            sortBy: sortBy,\n            getSortableProperties: getSortableProperties,\n            getSortablePropertiesWithTypes: getSortablePropertiesWithTypes\n          });\n        case 1:\n        case \"end\":\n          return _context9.stop();\n      }\n    }, _callee9);\n  }));\n  return _createSorter.apply(this, arguments);\n}","map":{"version":3,"names":["createError","innerCreate","schema","sortableDeniedProperties","prefix","sorter","enabled","sortableProperties","sortablePropertiesWithTypes","sorts","_i","_Object$entries","Object","entries","length","_Object$entries$_i","_slicedToArray","prop","type","typeActualType","path","concat","includes","Array","isArray","_sorter$sortablePrope","ret","push","apply","_toConsumableArray","_objectSpread","docs","orderedDocs","create","_x","_x2","_x3","_create","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_","config","isSortEnabled","wrap","_callee$","_context","prev","next","abrupt","disabled","unsortableProperties","stop","stringSort","value","language","d","localeCompare","numerSort","booleanSort","insert","_x4","_x5","_x6","_x7","_x8","_x9","_insert","_callee2","id","schemaType","s","predicate","index","orderedDocsLength","i","docId","_callee2$","_context2","t0","bind","findIndex","splice","remove","_x10","_x11","_x12","_remove","_callee3","_callee3$","_context3","sortBy","_x13","_x14","_x15","_sortBy","_callee4","docIds","by","property","isDesc","_callee4$","_context4","order","join","sort","a","b","indexOfA","indexOfB","isAIndexed","isBIndexed","getSortableProperties","_x16","_getSortableProperties","_callee5","_callee5$","_context5","getSortablePropertiesWithTypes","_x17","_getSortablePropertiesWithTypes","_callee6","_callee6$","_context6","load","_x18","_load","_callee7","raw","rawDocument","_callee7$","_context7","save","_x19","_save","_callee8","_callee8$","_context8","createSorter","_createSorter","_callee9","_callee9$","_context9"],"sources":["/home/krug/Coding/JavaScript/Websites/Personal/personal/node_modules/.pnpm/@orama+orama@1.0.3/node_modules/@orama/orama/src/components/sorter.ts"],"sourcesContent":["import { createError } from '../errors.js'\nimport { ISorter, OpaqueSorter, Orama, Schema, SorterConfig, SorterParams, SortType, SortValue } from '../types.js'\n\ninterface PropertySort<K> {\n  docs: Record<string, number>\n  orderedDocs: [string, K][]\n  type: SortType\n}\n\nexport interface Sorter extends OpaqueSorter {\n  enabled: boolean\n  sortableProperties: string[]\n  sortablePropertiesWithTypes: Record<string, SortType>\n  sorts: Record<string, PropertySort<number | string | boolean>>\n}\n\nexport type DefaultSorter = ISorter<Sorter>\n\nfunction innerCreate(schema: Schema, sortableDeniedProperties: string[], prefix: string): Sorter {\n  const sorter: Sorter = {\n    enabled: true,\n    sortableProperties: [],\n    sortablePropertiesWithTypes: {},\n    sorts: {},\n  }\n\n  for (const [prop, type] of Object.entries(schema)) {\n    const typeActualType = typeof type\n    const path = `${prefix}${prefix ? '.' : ''}${prop}`\n\n    if (sortableDeniedProperties.includes(path)) {\n      continue\n    }\n\n    if (typeActualType === 'object' && !Array.isArray(type)) {\n      // Nested\n      const ret = innerCreate(type as Schema, sortableDeniedProperties, path)\n      sorter.sortableProperties.push(...ret.sortableProperties)\n      sorter.sorts = {\n        ...sorter.sorts,\n        ...ret.sorts,\n      }\n      sorter.sortablePropertiesWithTypes = {\n        ...sorter.sortablePropertiesWithTypes,\n        ...ret.sortablePropertiesWithTypes,\n      }\n      continue\n    }\n\n    switch (type) {\n      case 'boolean':\n      case 'number':\n      case 'string':\n        sorter.sortableProperties.push(path)\n        sorter.sortablePropertiesWithTypes[path] = type\n        sorter.sorts[path] = {\n          docs: {},\n          orderedDocs: [],\n          type: type,\n        }\n        break\n      case 'boolean[]':\n      case 'number[]':\n      case 'string[]':\n        // We don't allow to sort by arrays\n        continue\n      default:\n        throw createError('INVALID_SORT_SCHEMA_TYPE', Array.isArray(type) ? 'array' : (type as unknown as string), path)\n    }\n  }\n\n  return sorter\n}\n\nasync function create(_: Orama, schema: Schema, config?: SorterConfig): Promise<Sorter> {\n  const isSortEnabled = config?.enabled !== false\n  if (!isSortEnabled) {\n    return {\n      disabled: true,\n    } as unknown as Sorter\n  }\n  return innerCreate(schema, (config || {}).unsortableProperties || [], '')\n}\n\nfunction stringSort(value: SortValue, language: string | undefined, d: [string, SortValue]): boolean {\n  return (d[1] as string).localeCompare(value as string, language) > 0\n}\nfunction numerSort(value: SortValue, d: [string, SortValue]): boolean {\n  return (d[1] as number) > (value as number)\n}\nfunction booleanSort(value: SortValue, d: [string, SortValue]): boolean {\n  return d[1] as boolean\n}\n\nasync function insert(\n  sorter: Sorter,\n  prop: string,\n  id: string,\n  value: SortValue,\n  schemaType: SortType,\n  language: string | undefined,\n): Promise<void> {\n  if (!sorter.enabled) {\n    return\n  }\n  const s = sorter.sorts[prop]\n\n  let predicate: (value: [string, SortValue]) => boolean\n  switch (schemaType) {\n    case 'string':\n      predicate = stringSort.bind(null, value, language)\n      break\n    case 'number':\n      predicate = numerSort.bind(null, value)\n      break\n    case 'boolean':\n      predicate = booleanSort.bind(null, value)\n      break\n  }\n\n  // Find the right position to insert the element\n  let index = s.orderedDocs.findIndex(predicate)\n  if (index === -1) {\n    index = s.orderedDocs.length\n    s.orderedDocs.push([id, value])\n  } else {\n    s.orderedDocs.splice(index, 0, [id, value])\n  }\n  s.docs[id] = index\n\n  // Increment position for the greather documents\n  const orderedDocsLength = s.orderedDocs.length\n  for (let i = index + 1; i < orderedDocsLength; i++) {\n    const docId = s.orderedDocs[i][0]\n    s.docs[docId]++\n  }\n}\n\nasync function remove(sorter: Sorter, prop: string, id: string) {\n  if (!sorter.enabled) {\n    return\n  }\n  const s = sorter.sorts[prop] as PropertySort<SortValue>\n\n  const index = s.docs[id]\n  delete s.docs[id]\n\n  // Decrement position for the greather documents\n  const orderedDocsLength = s.orderedDocs.length\n  for (let i = index + 1; i < orderedDocsLength; i++) {\n    const docId = s.orderedDocs[i][0]\n    s.docs[docId]--\n  }\n\n  s.orderedDocs.splice(index, 1)\n}\n\nasync function sortBy(sorter: Sorter, docIds: [string, number][], by: SorterParams): Promise<[string, number][]> {\n  if (!sorter.enabled) {\n    throw createError('SORT_DISABLED')\n  }\n\n  const property = by.property\n  const isDesc = by.order === 'DESC'\n\n  const s = sorter.sorts[property]\n  if (!s) {\n    throw createError('UNABLE_TO_SORT_ON_UNKNOWN_FIELD', property, sorter.sortableProperties.join(', '))\n  }\n\n  docIds.sort((a, b) => {\n    // This sort algorithm works leveraging on\n    // that s.docs is a map of docId -> position\n    // If a document is not indexed, it will be not present in the map\n    const indexOfA = s.docs[a[0]]\n    const indexOfB = s.docs[b[0]]\n    const isAIndexed = typeof indexOfA !== 'undefined'\n    const isBIndexed = typeof indexOfB !== 'undefined'\n\n    if (!isAIndexed && !isBIndexed) {\n      return 0\n    }\n    // unindexed documents are always at the end\n    if (!isAIndexed) {\n      return 1\n    }\n    if (!isBIndexed) {\n      return -1\n    }\n\n    return isDesc ? indexOfB - indexOfA : indexOfA - indexOfB\n  })\n\n  return docIds\n}\n\nasync function getSortableProperties(sorter: Sorter): Promise<string[]> {\n  if (!sorter.enabled) {\n    return []\n  }\n\n  return sorter.sortableProperties\n}\n\nasync function getSortablePropertiesWithTypes(sorter: Sorter): Promise<Record<string, SortType>> {\n  if (!sorter.enabled) {\n    return {}\n  }\n\n  return sorter.sortablePropertiesWithTypes\n}\n\nexport async function load<R = unknown>(raw: R): Promise<Sorter> {\n  const rawDocument = raw as Sorter\n  if (!rawDocument.enabled) {\n    return {\n      enabled: false,\n    } as unknown as Sorter\n  }\n\n  return {\n    sortableProperties: rawDocument.sortableProperties,\n    sortablePropertiesWithTypes: rawDocument.sortablePropertiesWithTypes,\n    sorts: rawDocument.sorts,\n    enabled: true,\n  }\n}\n\nexport async function save<R = unknown>(sorter: Sorter): Promise<R> {\n  if (!sorter.enabled) {\n    return {\n      enabled: false,\n    } as unknown as R\n  }\n\n  return {\n    sortableProperties: sorter.sortableProperties,\n    sortablePropertiesWithTypes: sorter.sortablePropertiesWithTypes,\n    sorts: sorter.sorts,\n    enabled: sorter.enabled,\n  } as R\n}\n\nexport async function createSorter(): Promise<DefaultSorter> {\n  return {\n    create,\n    insert,\n    remove,\n    save,\n    load,\n    sortBy,\n    getSortableProperties,\n    getSortablePropertiesWithTypes,\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}